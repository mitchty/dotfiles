#+TITLE: Nix Configuration
#+AUTHOR: Mitch Tishmack
#+STARTUP: hidestars
#+STARTUP: odd
#+BABEL: :cache yes
#+PROPERTY: header-args :tangle tmp/.nixpkgs/config.nix :cache yes :padline no :mkdirp yes :comments no

Nix user config.nix setup.

#+BEGIN_SRC conf :tangle (when (eq nix-p t) "tmp/.nixpkgs/config.nix")
let
  pkgs = import <nixpkgs> {};
in
{

  packageOverrides = pkgs: with pkgs;
  let in rec {
    custom-pinentry = pinentry.override { gtk2 = null; qt4 = null; ncurses = null; };
    custom-gnupg = gnupg.override { x11Support = false; };
    custom-youtube-dl = python27Packages.youtube-dl.override { pandoc = null; };

    custom-git = git.override {
      pythonSupport = false;
      svnSupport = true;
      guiSupport = false;
      sendEmailSupport = true;
    };

    default = buildEnv {
      name = "default";
      ignoreCollisions = true;
      paths = [
        ansible
        ack
        aria
        iperf
        cacert
        curl
        clang
        clang-analyzer
        ctags
        diffutils
        patchutils
        custom-git
        gitAndTools.gitFull
        gitAndTools.git-extras
        bazaarTools
        mercurial
        subversionClient
        gist
        mercurial
        docbook5
        entr
        emacs
        gnupg
        gnupg1compat
        gnutar
        gnumake
        sloccount
        cloc
        less
        multitail
        rlwrap
        gdbm
        mosh
        htop
        imagemagick
        keychain
        silver-searcher
        aspell
        aspellDicts.en
        openssl
        custom-pinentry
        poppler_utils
        ghostscript
        pbzip2
        pigz
        pv
        pkgconfig
        postgresql
        readline
        rsync
        sqlite
        tmux
        texlive.combined.scheme-full
        tree
        wget
        wakelan
        unzip
        upx
        xz
        multimarkdown
        jq
        p7zip
        unrar
        watch
        nox
        graphviz-nox
        mutt
        duply
        lastpass-cli
        custom-youtube-dl
        python27Packages.howdoi
        python27Packages.pyflakes
        python27Packages.flake8
        python27Packages.virtualenv
        python27Packages.pip
        python27Packages.pylint
        haskellPackages.bake
        haskellPackages.cabal-dependency-licenses
#        haskellPackages.cabal-install
        haskellPackages.ghc-core
        haskellPackages.ghc-mod
        haskellPackages.hasktags
        haskellPackages.hindent
        haskellPackages.hoogle
        haskellPackages.hspec
        haskellPackages.pandoc
        haskellPackages.shake
        haskellPackages.ShellCheck
        haskellPackages.stack
      ] ++ stdenv.lib.optionals stdenv.isLinux [
        # some of these are broken on osx, fix them
        rtags
        cscope
        gcc
# disabled for now
#      ] ++ stdenv.lib.optionals stdenv.isDarwin [
#        xhyve        compiles normally, figure out hypervisor framework issue
      ];
    };
  };
  allowUnfree = true;
  allowBroken = true;
}
#+END_SRC
